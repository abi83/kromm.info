{% extends "base.html" %}
{% load static i18n %}
{% load thumbnail %}

{% block content %}
  <link rel="preload" href="{% static '/my/cv-detail.css' %}" as="style" onload="this.onload=null;this.rel='stylesheet'">
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Bitter:ital,wght@0,400;1,400;1,600&display=swap" rel="stylesheet">

  <!--html 2 pdf-->
  <script src="{% static 'my/html2pdf.bundle.min.js' %}"></script>

  <script type="text/javascript">
    window.onload = function () {
      document.getElementById('download-button')
        .addEventListener('click', () => {
          const cv = this.document.querySelector('.cv');
          var options = {
            margin: 0,
            filename: 'WladimirKromm-CV.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 2 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
          };
          const setFont = (size) => {
            document.querySelector('.cv').style.fontSize = size;
          }
          async function go() {
            setFont('11px');
            await html2pdf()
              .from(cv)
              .set(options)
              .save(options.filename, {returnPromise: true})
              .then(()=>{
                setFont('14px')
                });
            }
            go();
          })
  }
  </script>

  <button class="btn btn-primary" id="download-button">Download</button>
  <div class="cv-wrapper">
    <article class="cv">
    <section class="cv-header">
      <h1 class="cv-h1">Кромм Владимир</h1>
      <h3 class="cv-subheader">{{ cv.position }}</h3>
      <div class="cv-header-icon">
        <i class="far fa-envelope"></i>
        <a href="mailto:wladimir@kromm.info">wladimir@kromm.info</a>
      </div>
      <div class="cv-header-icon">
        <i class="fas fa-phone"></i>
        <a href="tel:+79130073119">+7-913-007-3119</a>
      </div>
      <div class="cv-header-icon">
        <i class="fas fa-map-marker-alt"></i>
        <p>Berlin, DE</p>
      </div>
      <div class="cv-header-icon">
        <i class="fab fa-linkedin"></i>
        <a href="https://www.linkedin.com/in/vkromm/?locale=en_US">LinkedIn</a>
      </div>
      <div class="cv-header-icon">
        <i class="fab fa-github-square"></i>
        <a href="https://github.com/abi83">GitHub</a>
      </div>
    </section>
    <section class="cv-secondary">
      <div class="cv-section">
        <h2 class="cv-h2">Образование</h2>
        {% for uni in cv.education.all %}
          <h3 class="cv-subheader">{{ uni.name }}</h3>
          <p class="common"><b>{{ uni.degree }}</b></p>
          <div class="cv-header-icon">
            <i class="far fa-calendar-alt"></i>
            <p class="common">{{ uni.start_date|date:'M.Y' }} - {{ uni.end_date|date:'M.Y' }}</p>
          </div>
        {% endfor %}
      </div>
      <div class="cv-section">
        <h2 class="cv-h2">Скилы</h2>
        {% for skill in cv.skills.all %}
          <p class="common">{{ skill }}</p>
        {% endfor %}
      </div>
    </section>
    <section class="cv-main">
      <div class="cv-section">
        <h2 class="cv-h2">Обо мне</h2>
        <p class="common">
          {{ cv.text }}
        </p>
      </div>
      <div class="cv-section">
        <h2 class="cv-h2">Опыт работы</h2>
        {% for job in cv.jobs.all %}
          <h3 class="cv-subheader"><b>{{ job.name }}</b></h3>
          <p class="common"><b>{{ job.position }}</b></p>
          <div class="cv-header-icon">
            <i class="far fa-calendar-alt"></i>
            <p class="common">{{ job.start_date|date:'M.Y' }} - {{ job.end_date|date:'M.Y' }}</p>
          </div>
          <div class="common">{{ job.description|safe }}</div>
        {% endfor %}
      </div>
    </section>
  </article>
  </div>
{% endblock %}